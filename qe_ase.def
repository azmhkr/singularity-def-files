BootStrap: docker

From: ubuntu:latest

%post
    apt-get update
    apt-get install -y wget build-essential git gfortran openmpi-bin libopenmpi-dev
    apt-get install -y python3-dev python3-pip libfftw3-3 libfftw3-dev libfftw3-doc

    wget https://github.com/QEF/q-e/archive/refs/tags/qe-7.0.tar.gz
    tar -xvf qe-7.0.tar.gz
    cd q-e-qe-7.0
    ./configure MPIF90=mpif90 F90=gfortran F77=gfortran CC=gcc --enable-openmp --enable-parallel
    make pw
    make install

    # install python libraries
    pip install ase numpy scipy matplotlib pandas

%runscript
    #!/bin/bash
    export ASE_ESPRESSO_COMMAND="mpirun pw.x <./espresso.pwi > ./espresso.pwo"
    python ${1}
